5 D$ =  CHR$ (4): PRINT D$;"PR#3": PRINT CHR$ (12); : REM ENABLE 80 COL

10 POKE 49239,0: REM TURN ON HIRES

45 REM POKE 49236,0: REM PAGE ONE
50 REM POKE 49165,100: REM TURN ON 80COLUMS
60 REM 60 POKE 49153,100:POKE 49237,100:POKE 8192,14: REM TURN ON 80STOR, TURN ON PAGE2, WRITE AQUA PIXEL

70 POKE 49237,0: PRINT D$;"BLOAD TITLE, A$2000, L$2000"
72 POKE 49236,0: PRINT D$;"BLOAD TITLE, A$2000, L$2000, B$2000"

74 POKE 49232,0: REM TURN ON GRAPHICS
76 POKE 49234,0: REM TURN ON FULLSCREEN /49235 MIXED/
78 POKE 49246,0: REM TURN ON DHR

80 REM CALL -678 : REM wait for ENTER/RETURN press

84  CALL  - 1998 : REM  CLEAR a whole LOW RES page
86  POKE 49237,0 : REM  switch page 2
88  CALL  - 1998 : REM  CLEAR a whole LOW RES page
96 REM POKE -16298,0 : REM switch to LOW RES graphics
98 GOTO 155 : REM DEBUG
99  REM  LOOP
100  REM  COLORS
101  LET B1 = 1: LET B2 = 2: REM  BLUE
102  LET G1 = 2: LET G2 = 4: REM  GREEN
103  LET L1 =10: LET L2 = 6: REM  LIGHT BLUE
104  LET N1 = 4: LET N2 = 8: REM  BROWN
105  LET W1 = 5: LET W2 = 10: REM  WHITE
106  LET I1 = 6: LET I2 = 12: REM  LIGHT GREEN
107  LET C1 = 7: LET C2 = 14: REM  CYAN
108  LET R1 = 8: LET R2 = 1: REM  RED
109  LET V1 = 9: LET V2 = 3: REM  VIOLET
110  LET F1 = 10: LET F2 = 5: REM  GREY
111  LET O1 = 12: LET O2 = 9: REM  ORANGE
112  LET U1 = 11: LET U2 = 7: REM  BLUE METAL
113  LET P1 = 13: LET P2 = 11: REM  PINK
114  LET Y1 = 14: LET Y2 = 13: REM  YELLOW
115  LET E1 = 0: LET E2 = 0: REM   EMPTY BLACK
116  LET A1 = C1: LET A2 = C2: REM  CURRENT
117  LET W = 4: LET H = 8
119 BW = 6:BH = 6: DIM LV(BW,BH): DIM RV(BW,BH)
120 LV(0,0) = V1:RV(0,0) = V2:LV(0,1) = V1:RV(0,1) = V2:LV(0,2) = V1:RV(0,2) = V2:LV(0,3) = E1:RV(0,3) = E2:LV(0,4) = Y1:RV(0,4) = Y2:LV(0,5) = N1:RV(0,5) = N2
121 LV(1,0) = E1:RV(1,0) = E2:LV(1,1) = E1:RV(1,1) = E2:LV(1,2) = E1:RV(1,2) = E2:LV(1,3) = E1:RV(1,3) = E2:LV(1,4) = Y1:RV(1,4) = Y2:LV(1,5) = N1:RV(1,5) = N2
122 LV(2,0) = R1:RV(2,0) = R2:LV(2,1) = R1:RV(2,1) = R2:LV(2,2) = C1:RV(2,2) = C2:LV(2,3) = E1:RV(2,3) = E2:LV(2,4) = Y1:RV(2,4) = Y2:LV(2,5) = N1:RV(2,5) = N2
123 LV(3,0) = E1:RV(3,0) = E2:LV(3,1) = E1:RV(3,1) = E2:LV(3,2) = C1:RV(3,2) = C2:LV(3,3) = L1:RV(3,3) = L2:LV(3,4) = L1:RV(3,4) = L2:LV(3,5) = E1:RV(3,5) = E2
124 LV(4,0) = E1:RV(4,0) = E2:LV(4,1) = E1:RV(4,1) = E2:LV(4,2) = E1:RV(4,2) = E2:LV(4,3) = E1:RV(4,3) = E2:LV(4,4) = E1:RV(4,4) = E2:LV(4,5) = E1:RV(4,5) = E2
125 LV(5,0) = E1:RV(5,0) = E2:LV(5,1) = B1:RV(5,1) = B2:LV(5,2) = B1:RV(5,2) = B2:LV(5,3) = G1:RV(5,3) = G2:LV(5,4) = G1:RV(5,4) = G2:LV(5,5) = E1:RV(5,5) = E2
130  FOR Y = 0 TO BH - 1
132  FOR X = 0 TO BW - 1
133  POKE 49237,0 : POKE (16337 + X + Y),100: POKE 49237,0 : POKE (16337 + X + Y),100 : REM LOADING
135  IF LV(Y,X) <  > E1 THEN  GOSUB 200
141  NEXT : NEXT 
144 Y = 2:X = 2
145  FOR J = 0 TO H - 1
147  GOSUB 300
148  GOSUB 400
149  NEXT 
150 Y = 2:X = 0:A1 = R1:A2 = R2
151  FOR J = 0 TO W
152  GOSUB 500
153  GOSUB 600
154  NEXT : REM CALL -678 : REM wait for ENTER/RETURN press | POKE -16298,0 : REM switch to LOW RES graphics
155 REM DEBUG / POKE 49157,0
156 REM POKE 49157,0
157 POKE 49237,0: PRINT D$;"BLOAD MOON, A$2000, L$2000" 
160 POKE 49236,0: PRINT D$;"BLOAD MOON, A$2000, L$2000, B$2000"
166 REM POKE 49152,0 : POKE 49236,0 : REM SWITCH PAGE 2
170  END 
175  FOR Z = 0 TO W
180  VLIN Y * H + J,Y * H + H - 1 + J AT Z + X * (W + 1)
185  NEXT 
190  RETURN 
200  POKE 49237,0: COLOR= LV(Y,X): GOSUB 175: POKE 49236,0: COLOR= RV(Y,X): GOSUB 175: RETURN 
299  REM  PAINT ONE LINE WITH BLACK
300  POKE 49237,0: COLOR= 0: HLIN X * W + 2,X * W + W + 2 AT J + Y * BH + 4: POKE 49236,0: COLOR= 0: HLIN X * W + 2,X * W + W + 2 AT J + Y * BH + 4: RETURN 
399  REM  PAINT ONE LINE WITH COLOR
400  POKE 49237,0: COLOR= A1: HLIN X * W + 2,X * W + W + 2 AT J + (Y + 3) * BH + 2: POKE 49236,0: COLOR= A2: HLIN X * W + 2,X * W + W + 2 AT J + (Y + 3) * BH + 2: RETURN 
499  REM  PAINT ONE ROW WITH BLACK
500  POKE 49237,0: COLOR= 0: VLIN Y * H,Y * H + H - 1 AT J + X * (W + 1): POKE 49236,0: COLOR= 0: VLIN Y * H,Y * H + H - 1 AT J + X * (W + 1): RETURN 
599  REM  PAINT ONE ROW WITH COLOR
600  POKE 49237,0: COLOR= A1: VLIN Y * H,Y * H + H - 1 AT J + (X + 2) * (W + 1): POKE 49236,0: COLOR= A2: VLIN Y * H,Y * H + H - 1 AT J + (X + 2) * (W + 1): RETURN